<!DOCTYPE html>
<html lang="en">

  <head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js" integrity="sha384-ka7Sk0Gln4gmtz2MlQnikT1wXgYsOg+OMhuP+IlRH9sENBO0LRn5q+8nbTov4+1p" crossorigin="anonymous"></script>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-1BmE4kWBq78iYhFldvKuhfTAU6auU8tT94WrHftjDbrCEXSU1oBoqyl2QvZ6jIW3" crossorigin="anonymous">
    <link rel="stylesheet" href="/_src/styles/fonts.css">
    <link rel="stylesheet" href="/_src/styles/header.css">
    <link rel="stylesheet" href="/_src/styles/main.css">
    <link rel="stylesheet" href="/_src/styles/topbar.css">
    <link rel="stylesheet" href="/_src/styles/sidebar.css">
    <link rel="stylesheet" href="/_src/styles/lesson.css">
    <link rel="stylesheet" href="/_src/styles/code.css">
    <link rel="stylesheet" href="/_src/styles/footer.css">
    <link rel="stylesheet" href="/_src/styles/responsive.css">
    <script src="https://kit.fontawesome.com/2c38f3d850.js" crossorigin="anonymous"></script>

    <title> | Módulo 3 - Backend </title>
  </head>

  <body>
    <div class="reader-bar-start">

      <div class="headerResponsive">
        <div class="leftContent">
          <span><img src="/_src/assets/logo-white.png" alt='logo Henry' height=22px class="d-inline-block align-text-top"></span><span></span>
        </div>
        <div class="menuDiv">
          <input type="checkbox">
          <i class="fas fa-bars"></i>
          <i class="fas fa-times"></i>
          <nav>
            <ul><li><a href="/">Intro</a></li>
<li><a href="/Node/">Node</a></li>
<li><a href="/Promises/">Promises</a></li>
<li><a href="/WebServer/">Web Server</a></li>
<li><a href="/AdvancedPromises/">Advanced Promises</a></li>
<li><a href="/Express/">Express</a></li>
<li><a href="/Testing/">Testing</a></li>
<li><a href="/AsyncAwait/">Async/Await</a></li></ul>
          </nav>
        </div>
      </div>

      <div class="headerContainer">
        <div class="headerContained">
          <img src="/_src/assets/logo-white.png" alt='logo Henry' height=27px class="d-inline-block align-text-top">
          <div>
            <span class="lessonTitle"></span> | <span>Módulo 3 - Backend</span>
          </div>
        </div>
      </div>

      <main>
        <div class="topnav" id='myTopnav' >
          
          <ul class="nav">
      
      <li class="link">
        <a href="/" class="nav-link" role="menuitem">Intro</a>
      </li>
<li class="link">
        <a href="/Node/" class="nav-link" role="menuitem">Node</a>
      </li>
<li class="link">
        <a href="/Promises/" class="nav-link" role="menuitem">Promises</a>
      </li>
<li class="link">
        <a href="/WebServer/" class="nav-link" role="menuitem">Web Server</a>
      </li>
<li class="link">
        <a href="/AdvancedPromises/" class="nav-link" role="menuitem">Advanced Promises</a>
      </li>
<li class="link">
        <a href="/Express/" class="nav-link" role="menuitem">Express</a>
      </li>
<li class="link">
        <a href="/Testing/" class="nav-link" role="menuitem">Testing</a>
      </li>
<li class="link">
        <a href="/AsyncAwait/" class="nav-link" role="menuitem">Async/Await</a>
      </li>
    </ul>
        </div>

        <div class='sidebar'>
          <div class="tocTitle">
            Contenido de la clase
            </div>
          <div class="tocBox">
            
            <nav class="toc" >
        <ul><li><a href="#node-js-homework">Node Js Homework </a></li><li><a href="#filosof%C3%ADa-unix">Filosofía UNIX </a></li><li><a href="#archivos">Archivos </a></li><li><a href="#objetivo-del-homework">Objetivo del homework </a></li><li><a href="#variable-process">Variable process </a></li><li><a href="#creando-comandos">Creando Comandos </a><ul><li><a href="#pwd-y-date">pwd y date </a></li></ul></li><li><a href="#mejorando-el-workflow">Mejorando el Workflow </a></li><li><a href="#separando-en-m%C3%B3dulos">Separando en módulos </a></li><li><a href="#agregando-comandos">Agregando Comandos </a><ul><li><a href="#ls-(list)">ls (list) </a></li><li><a href="#echo">echo </a></li><li><a href="#cat%2C-head%2C-y-tail">cat, head, y tail </a></li><li><a href="#curl">curl </a></li></ul></li><li><a href="#refactoreando">Refactoreando </a><ul><li><a href="#extra-credit%3A-otros-comandos-%C3%BAtiles">EXTRA CREDIT: Otros comandos útiles </a></li></ul></li></ul>
      </nav>
          </div>
        </div>

        <div class='lesson'>
          <div style="display:flex; justify-content: right; right: 0; width: 100%;">
            <div class="readingTime">
                    Tiempo de lectura 19 min
            </div>
          </div>
          <div>
            
            <h1 id="henry" tabindex="-1">Henry <a class="anchor-link" href="#henry"></a></h1>
<h2 id="node-js-homework" tabindex="-1">Node Js Homework <a class="anchor-link" href="#node-js-homework"></a></h2>
<h2 id="filosof%C3%ADa-unix" tabindex="-1">Filosofía UNIX <a class="anchor-link" href="#filosof%C3%ADa-unix"></a></h2>
<p>La ‘filosofía Unix’ fue originada con las reflexiones de Ken Thompson sobre cómo diseñar un sistema operativo pequeño, capaz y con una interfaz de servicio limpia.</p>
<p>Doug McIlroy, el inventor de los Unix pipes y uno de los fundadores de la tradición Unix, decía:</p>
<pre><code class="hljs">Lográ que cada programa haga una cosa bien. Para hacer un nuevo trabajo, creá un nuevo programa antes que complicar uno viejo agregando nuevas funciones.
Esperá que el output de cada programa se convierta en el input de otro todavía desconocido. No llenes el output de información extraña. Evitá los formatos de entrada en columnas o binarios. No insistas con inputs interactivos.
Diseñá y creá software, incluso sistemas operativos, que sean probados tempranamente (idealmente dentro de semanas). No dudes en descartar las partes torpes y reconstruirlas.
Usá herramientas para aligerar la tarea de programar, incluso si tenés que desviarte para construirlas. Descartá algunas de ellas después de haberlas usado.
</code></pre>
<p><a href="https://www.youtube.com/watch?v=tc4ROCJYbm0">Acá</a> hay un video de los 70’s para profundizar más en la filosofía Unix.</p>
<h2 id="archivos" tabindex="-1">Archivos <a class="anchor-link" href="#archivos"></a></h2>
<p>Tenes creados dos archivos <code>bash.js</code> y <code>commands/index.js</code>. En estos dos archivos vas a escribir todo el código para realizar el homework.</p>
<h2 id="objetivo-del-homework" tabindex="-1">Objetivo del homework <a class="anchor-link" href="#objetivo-del-homework"></a></h2>
<p>En este homework vas a tener que implementar comandos bash (a.k.a terminal) comunes usando Node.js.</p>
<p>Básicamente, cuando ejecutemos <code>node bash.js</code> vamos a obtener un <code>prompt</code> parecido al de la terminal de linux o git, en donde vamos a poder escribir una serie finita de comandos.</p>
<p>También, en el proceso de escribir tu propia shell, vas a descubrir tres cosas:</p>
<pre><code class="hljs">Que tu terminal Bash es un entorno de programación y está impulsado por la Filosofía Unix. Deberás crear pequeños programas que pueden inter-operar entre ellos.
Aprenderás los beneficios y las contras de una plataforma asincrónica.
Descubrirás cómo componer y manejar operaciones paralelas que pueden completarse en cualquier momento.
</code></pre>
<h2 id="variable-process" tabindex="-1">Variable <code>process</code> <a class="anchor-link" href="#variable-process"></a></h2>
<p>Para realizar este homework, vamos a trabajar directament tomando <code>inputs</code> desde el teclado (como la terminal), y escribiendo el resultado de un comando en la pantalla <code>ouput</code>.</p>
<p>Para hacer esto, vamos a usar los métodos dentro del objeto <code>process</code>. El objeto process es un objeto global y puede ser accedido desde cualquier parte. Es una instancia de <code>EventEmitter</code>. Contiene diversos métodos, eventos y propiedades que nos sirven no solo para obtener datos del proceso actual, sino también para controlarlo.</p>
<p>Instrucciones para saber qué es la variable process:</p>
<pre><code class="hljs">En tu bash.js, hacé un console.log de la variable process. Al ser global está disponible en cualquier lugar de nuestro programa de Node y no necesita ser creada.
Logueá Object.keys(process) para ver una lista de todas las propiedades.
</code></pre>
<h4 id="stdin-y-stdout" tabindex="-1">STDIN y STDOUT <a class="anchor-link" href="#stdin-y-stdout"></a></h4>
<p>Los métodos <code>stdin</code> y <code>stdout</code> viene de standard input y standard output. Estos métodos <em>conectan</em> el mundo exterior con el interior del programa de Node. Es decir, que podemos meter datos y sacar datos usandólos.</p>
<blockquote>
<p>De hecho, el console.log de Node es un pequeño wrapper alrededor de stdout.</p>
</blockquote>
<p>Veamos el siguente ejemplo:</p>
<pre class="language-js"><code class="hljs language-js">    <span class="token comment">// Output un prompt</span><br>    process<span class="token punctuation">.</span>stdout<span class="token punctuation">.</span><span class="token function">write</span><span class="token punctuation">(</span><span class="token string">'prompt > '</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>    <span class="token comment">// El evento stdin 'data' se dispara cuando el user escribe una línea</span><br>    process<span class="token punctuation">.</span>stdin<span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">'data'</span><span class="token punctuation">,</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">data</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><br>      <span class="token keyword">var</span> cmd <span class="token operator">=</span> data<span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">trim</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// remueve la nueva línea</span><br>      process<span class="token punctuation">.</span>stdout<span class="token punctuation">.</span><span class="token function">write</span><span class="token punctuation">(</span><span class="token string">'You typed: '</span> <span class="token operator">+</span> cmd<span class="token punctuation">)</span><span class="token punctuation">;</span><br>      process<span class="token punctuation">.</span>stdout<span class="token punctuation">.</span><span class="token function">write</span><span class="token punctuation">(</span><span class="token string">'\nprompt > '</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre>
<p>Copia ese código en <code>bash.js</code> y ejecutalo con <code>node bash.js</code>.</p>
<p>Cómo ven, lo primero que sale es <code>prompt &gt;</code>, esto es porque stdout escribió eso en la consola.<br>
<code>stdin</code> es un poco más complejo, porque vos no sabés cuando alguien va a escribir algo. Como sabemos, estos métodos son instancias de <code>EventEmitter</code>, por lo que se comportan como los eventos que vimos en el browser. Lo que ocurre es que estamos poniendo un <code>Event Listener</code> en el stdin, y cada vez que llegan datos (este es el evento), se ejecuta la función que pasamos como callback.</p>
<p>Nuestro proceso, esta vez, no termina inmediatamente. Eso es porque hemos registrado un listener a stdin, entonces Node asume que querés seguir esperando por otro input por parte del usuario. Si querés salir de tu proceso de Node, usá CTRL+C que es la forma normal de interrumpir cualquier proceso.</p>
<h2 id="creando-comandos" tabindex="-1">Creando Comandos <a class="anchor-link" href="#creando-comandos"></a></h2>
<h3 id="pwd-y-date" tabindex="-1"><code>pwd</code> y <code>date</code> <a class="anchor-link" href="#pwd-y-date"></a></h3>
<p>Vamos a crear nuestros primeros comando en nuestra pequeña terminal. <code>pwd</code> imprime el directorio donde estás <em>parado</em>. Y <code>date</code> imprime la fecha actual.</p>
<blockquote>
<p>Podes probar esos comando en tu consola (los originales). Depende del sistema operativo podrías no tenerlos, pero no te preocupes, no cambia nada.</p>
</blockquote>
<p>Ahora, vamos a escribir código para poder implementar esos comandos en <code>bash.js</code>. Recordemos que el funcionamiento de una terminal es así:</p>
<pre><code class="hljs">- Muestra el `prompt`
- se queda esperando que ingreses un comando.
- ejecuta el comando e imprimi el resultado.
- vuelve al punto 1.
</code></pre>
<p>Por lo tanto, vamos a recibir el comando en <code>data</code>, cuando se dispare el evento de que se escribió algo (cuando el usuario escriba algo y presione enter). Luego, vamos a tomar ese dato, y vamos a ver que escribió, y según el comando tipeado, vamos a mostrar algo.</p>
<p>Abajo te muestro cómo quedaría y qué mostramos con el comando <code>date</code>.</p>
<pre class="language-js"><code class="hljs language-js"><br><span class="token keyword">const</span> commands <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'./commands'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br><br><span class="token comment">// Output un prompt</span><br>process<span class="token punctuation">.</span>stdout<span class="token punctuation">.</span><span class="token function">write</span><span class="token punctuation">(</span><span class="token string">'prompt > '</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br><span class="token comment">// El evento stdin 'data' se dispara cuando el user escribe una línea</span><br>process<span class="token punctuation">.</span>stdin<span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">'data'</span><span class="token punctuation">,</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">data</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><br>  <span class="token keyword">var</span> cmd <span class="token operator">=</span> data<span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">trim</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// remueve la nueva línea</span><br>  <span class="token keyword">if</span><span class="token punctuation">(</span>cmd <span class="token operator">===</span> <span class="token string">'date'</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><br>    process<span class="token punctuation">.</span>stdout<span class="token punctuation">.</span><span class="token function">write</span><span class="token punctuation">(</span><span class="token function">Date</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <br>  <span class="token punctuation">}</span><br>  <span class="token keyword">if</span><span class="token punctuation">(</span>cmd <span class="token operator">===</span> <span class="token string">'pwd'</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><br>    <span class="token operator">...</span><br>  <span class="token punctuation">}</span><br>  process<span class="token punctuation">.</span>stdout<span class="token punctuation">.</span><span class="token function">write</span><span class="token punctuation">(</span><span class="token string">'\nprompt > '</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre>
<p>Ahora te toca implementar cómo mostrar el <code>pwd</code> (print working directory). Tip: buscá dentro dell objeto <code>process</code>.</p>
<h2 id="mejorando-el-workflow" tabindex="-1">Mejorando el Workflow <a class="anchor-link" href="#mejorando-el-workflow"></a></h2>
<p>Ahora que vamos a empezar a probar varias cosas, vamos a sentir que cerrar y ejecutar nuestro programa cada vez que hagamos un cambio es un trabajo insoportable.</p>
<p>Por suerte, esto ya le pasó a otros, y crearon una solución. Se llama <code>nodemon</code>. Básicamente es un paquete de <code>npm</code> que podemos instalar con <code>npm install --save nodemon</code>. Y lo que hace es <code>watchear</code> por cambios en el código y reiniciar el programa cuando haya cambios.</p>
<p>Para que funcione debemos agregar el siguiente script al <code>package.json</code> (para inicializar el <code>package.json</code> podes usar <code>npm init</code>):</p>
<pre><code class="hljs">    // package.json
    ...
    &quot;scripts&quot;: {
        &quot;start&quot;: &quot;nodemon bash.js&quot;,
    ...
</code></pre>
<p>Para ejecutar el <code>bash.js</code> podes escribir el comando:</p>
<pre class="language-bash"><code class="hljs language-bash"><span class="token function">npm</span> start</code></pre>
<h2 id="separando-en-m%C3%B3dulos" tabindex="-1">Separando en módulos <a class="anchor-link" href="#separando-en-m%C3%B3dulos"></a></h2>
<p>De ver el código que tenemos en <code>bash.js</code> nos damos cuenta que si tuvieramos muchos comando sería muy díficil de gestionar, de hecho para agregar comandos ya estamos repitiendo código, y es algo que no deberíamos hacer. (Recuerden el código DRY - DO NOT REPEAT YOURSELF).</p>
<p>Por lo tanto, vamos a crear un módulo en <code>commands/index.js</code> donde vamos a tener todos los comandos, y vamos a exportarlos.</p>
<p>En nuestro <code>bash.js</code> vamos a importar estos comandos.</p>
<p>Veamos que si exportamos cada comando con su nombre como propiedad de un objeto, luego podremos buscarlo muy fácilmente desde el <code>bash.js</code>.</p>
<pre class="language-js"><code class="hljs language-js"><span class="token comment">// commands/index.js</span><br><br>module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span><br>    pwd<span class="token operator">:</span> <span class="token function">fn</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span><br>    date<span class="token operator">:</span> <span class="token function">fn</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><br><span class="token punctuation">}</span></code></pre>
<pre class="language-js"><code class="hljs language-js"><span class="token comment">// bash.js</span><br><span class="token keyword">const</span> commands <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'./commands/index.js'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br><br><span class="token keyword">const</span> cmd <span class="token operator">=</span> <span class="token string">'pwd'</span><span class="token punctuation">;</span><br><br>commands<span class="token punctuation">[</span>cmd<span class="token punctuation">]</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment">// la función dentro de la propiedad pwd</span><br></code></pre>
<h2 id="agregando-comandos" tabindex="-1">Agregando Comandos <a class="anchor-link" href="#agregando-comandos"></a></h2>
<p>Ahora vas a agregar código para que tu <code>bash</code> pueda ejecutar los siguientes comandos:</p>
<h3 id="ls-(list)" tabindex="-1">ls (list) <a class="anchor-link" href="#ls-(list)"></a></h3>
<p>Cada lenguaje de programación tiene una librería standard de módulos que hará tu trabajo mucho más fácil.</p>
<p>Uno de los más poderosos es el modulo <code>fs</code>. Éste permite acceder al sistema de archivos de la máquina de distintas formas.</p>
<p>Usá el modulo fs para implementar el siguiente comando ls:</p>
<pre><code class="hljs">Creá una nueva función llamada ls en commands.js.
Cuando el usuario tipee ls, ejecutá la función ls.
</code></pre>
<p>No te olvides: fs no es global (como process) pero es un módulo. Esto significa que vas a necesitar requerirlo:</p>
<p><code>var fs = require('fs');</code></p>
<p>Usá <code>fs.readdir</code> para obtener los archivos en el directorio:</p>
<pre class="language-js"><code class="hljs language-js"><span class="token comment">// commands/index.js</span><br><span class="token operator">...</span><br>fs<span class="token punctuation">.</span><span class="token function">readdir</span><span class="token punctuation">(</span><span class="token string">'.'</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">err<span class="token punctuation">,</span> files</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><br>  <span class="token keyword">if</span> <span class="token punctuation">(</span>err<span class="token punctuation">)</span> <span class="token keyword">throw</span> err<span class="token punctuation">;</span><br>  files<span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">file</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><br>    process<span class="token punctuation">.</span>stdout<span class="token punctuation">.</span><span class="token function">write</span><span class="token punctuation">(</span>file<span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">"\n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>  <span class="token punctuation">}</span><span class="token punctuation">)</span><br>  process<span class="token punctuation">.</span>stdout<span class="token punctuation">.</span><span class="token function">write</span><span class="token punctuation">(</span><span class="token string">"prompt > "</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br><span class="token operator">...</span></code></pre>
<h3 id="echo" tabindex="-1">echo <a class="anchor-link" href="#echo"></a></h3>
<p>El comando <code>echo</code> básicamente manda los argumento al <code>stdout</code>.<br>
Si ejecutaras <code>echo hola</code>, va a salir un <code>hola</code> en la terminal. Podríamos decir que es el <code>console.log</code> de la terminal!</p>
<pre class="language-js"><code class="hljs language-js"><span class="token comment">/// si ejecutas el comando echo deberias ver lo siguiente:</span><br>    prompt <span class="token operator">></span> echo hello world<br>    hello world</code></pre>
<p>Para este comando, vas a tener que modificar la forma en que parsear el input (<code>data</code>) dentro de la <code>función process.stdin.on('data', function (data) { ...</code></p>
<blockquote>
<p>Intenta hacer que <code>echo</code> también imprima variables del sistema</p>
</blockquote>
<h3 id="cat%2C-head%2C-y-tail" tabindex="-1">cat, head, y tail <a class="anchor-link" href="#cat%2C-head%2C-y-tail"></a></h3>
<p>Estos tres comandos sirven para leer archivos y mostrarlos por el <code>stdout</code>.</p>
<ul>
<li>cat: muestra todo el contenido de un archivo, ej: <code>cat bash.js</code>.</li>
<li>head: muestra las primeras lineas de un archivo, no todo el archivo. ej: <code>head bash.js</code></li>
<li>tail: muestra las últimas líneas de un archivo. ej: <code>tail bash.js</code></li>
</ul>
<p>Refactoreá todas tus funciones existentes para tomar un parámetro explícito, aunque no lo usen.</p>
<p>¿Para qué? Estructurá a todos tus comandos de la misma manera (orden y tipo de parámetros). Así podés ejecutar a todos de la misma manera, sin saber a cuál estás llamando. Para la mayoría de las próximas funciones, nombrá ese parámetro file o filename.</p>
<h3 id="curl" tabindex="-1">curl <a class="anchor-link" href="#curl"></a></h3>
<p><code>curl</code> es un comando útil para descargar páginas web. En vez de ejecutarse con el nombre de un archivo, se hace con una URL.</p>
<p>Deberás implementar curl usando el módulo <code>request</code> (vas a tener que instalarlo):</p>
<p><code>npm install --save request</code></p>
<p>También lo podés hacer por el módulo nativo http, pero es menos amigable.</p>
<p>Ahora que tenés <code>request</code> disponible para requerir, implementá el comando <code>curl</code>. <code>curl</code> hará un pedido GET de HTTP a un URL dado, e imprimirá el body del response del HTTP.</p>
<p>ej: <code>curl http:www.google.com</code></p>
<h2 id="refactoreando" tabindex="-1">Refactoreando <a class="anchor-link" href="#refactoreando"></a></h2>
<p>Bien, si llegaste hasta acá te habrás dado cuenta que hay muchas partes del código donde repetimos cosas. Ahora vamos a tomar el tiempo para refactorearlas.</p>
<p>Notarás estos patrones repetidos:</p>
<pre><code class="hljs">- Ejecutar el trabajo del comando.
- Mostrar el resultado del comando.
- Mostrar el prompt y esperar al próximo comando.
</code></pre>
<p>Lo único que es propio de nuestra función es el paso 1. Los otros se repiten para cada comando.</p>
<p>Usá una función callback para remover los pasos 2 y 3. Creá una función <code>done</code> en bash.js que tome un argumento output.</p>
<p>const done = function(output) {<br>
// muestra el output<br>
// muestra el prompt<br>
}</p>
<p>Ahora pasá <code>done</code> a cada una de las funciones de los comandos y reescribí los comandos para que creen el output pero que no lo impriman (no uses process.stdout). Luego de que se hayan completado, llamá a <code>done</code>.</p>
<p>Acá hay un ejemplo con ls:</p>
<pre class="language-js"><code class="hljs language-js"><span class="token keyword">const</span> commands <span class="token operator">=</span> <span class="token punctuation">{</span><br>  <span class="token function-variable function">ls</span><span class="token operator">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">file<span class="token punctuation">,</span> done</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><br>    <span class="token keyword">var</span> output <span class="token operator">=</span> <span class="token string">""</span><span class="token punctuation">;</span><br>    fs<span class="token punctuation">.</span><span class="token function">readdir</span><span class="token punctuation">(</span><span class="token string">'.'</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">err<span class="token punctuation">,</span> files</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><br>      files<span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">file</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><br>        output <span class="token operator">+=</span> file<span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">"\n"</span><span class="token punctuation">;</span><br>      <span class="token punctuation">}</span><span class="token punctuation">)</span><br>      <span class="token function">done</span><span class="token punctuation">(</span>output<span class="token punctuation">)</span><span class="token punctuation">;</span><br>    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>  <span class="token punctuation">}</span><br><span class="token punctuation">}</span></code></pre>
<h3 id="extra-credit%3A-otros-comandos-%C3%BAtiles" tabindex="-1">EXTRA CREDIT: Otros comandos útiles <a class="anchor-link" href="#extra-credit%3A-otros-comandos-%C3%BAtiles"></a></h3>
<p>Probá implementar alguno de estos comandos.</p>
<ul>
<li><code>sort filename.txt</code>: Devuelve el archivo ordenado lexicográficamente por línea.</li>
<li><code>wc filename.txt</code>: El wc de Unix imprime el conteo de líneas, palabras y caracteres de un archivo. El tuyo puede simplemente devolver el número de líneas.</li>
<li><code>uniq filename.txt</code>: Si una línea en un archivo es la misma que la línea de arriba, la saca del resultado. Un archivo que esta ordenado( sort) y después filtrado por únicos ( uniq) te garantiza que no tendrá ni una sola línea duplicada.</li>
</ul>
<h4 id="materiales-recomendados" tabindex="-1">Materiales recomendados <a class="anchor-link" href="#materiales-recomendados"></a></h4>
<p><a href="https://www.youtube.com/watch?v=8aGhZQkoFbQ&amp;feature=youtu.be&amp;t=676">Video: Philip Roberts: What the heck is the event loop anyway?</a></p>

          </div>
        </div>

      </main>

      <div class="feedback">
        <a href='https://airtable.com/shrBpWkYV4K12PPNZ?prefill_clase=' target="_blank">
          Dejanos tu feedback!👍
        </a>
      </div>

      <div class="footerContainer">
        <div class="footerContained">
          <p>Hecho con 💛 por alumnos de Henry</p>
        </div>
      </div>

      <div class="readerBarDiv">
        
  <!-- up button -->
  <div>
    <button
      id="upBtn"
      style="position:fixed; width:32px; height:32px; border-radius:50%; border:none; background-color:black; right:20px; bottom:55px; color:white; z-index:999; focus:outline-none; cursor:pointer; transition-duration:500ms; opacity:0; pointer-events:none;"
    ><i class="arrow up"></i></button>
  </div>
  
  <style>
  .arrow {
    border: solid white;
    border-width: 0 3px 3px 0;
    display: inline-block;
    padding: 3px;
  }

  .up {
    transform: rotate(-135deg);
    -webkit-transform: rotate(-135deg);
  }
  </style>

  <script>
  window.addEventListener('scroll', () => {
    if (window.scrollY > 250) {
      upBtn.style.opacity = 1;
      upBtn.style.pointerEvents = 'auto';     
    }
    else {
      upBtn.style.opacity = 0;
      upBtn.style.pointerEvents = 'none';
    }
  })

  upBtn.addEventListener('click', () => {
    let start = document.querySelector('.reader-bar-start')
    start.scrollIntoView({behavior: "smooth"})
  })
  </script>

  <!-- reader bar -->
  <div id="readerBarContainer" style="height:3px;width:100%;background-color:black;position:fixed;top:66px;left:0;z-index:1099;transition:0.2s;">
    <div id="readerBar" style="height:3px;width:0;background-color:yellow;position:fixed;top:66px;left:0;z-index:1099;transition:0.2s;"></div>
  </div>

  <script>
    let winH = window.innerHeight;
    const content = document.querySelector('.reader-bar-start');

    let contentH = content.offsetHeight;
    let contentS = contentH - winH;
    let readerBar = document.getElementById('readerBar');
    window.addEventListener('load', () => {
      document.addEventListener ('scroll', updateBar);
    })
    window.addEventListener('resize', redefine)

    function redefine() {
      winH = window.innerHeight;
      contentH = content.offsetHeight;
      contentS = contentH - winH;
      updateBar();
    }

    function updateBar() {
      const pagePos = window.scrollY; 
      const updatedBar = pagePos * 100 / contentS;
      readerBar.style.width = updatedBar + "%";
    }
  </script>
  
      </div>

    </body>
  </html>